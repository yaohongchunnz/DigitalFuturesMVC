@model Dont_Panic_MVC_API.Models.ViewJob

@{
    ViewBag.Title = "Post Job";
}
<br />
<script language="javascript" type="text/javascript">
    window.onload = function () {
        if (sessionStorage.jobtitle != null) {
            document.getElementById("title").value = sessionStorage.jobtitle;
            var jobselect = document.getElementById("jobtype");
            for (var i = 0; i < jobselect.length; i++) {
                if (jobselect.options[i].text == sessionStorage.jobtype) {
                    jobselect.options[i].selected = true;
                }
            }
            sessionStorage.clear();

        }
        setDistrict(false);
        setSuburb(false);
    }

    var previousReg;
    function showHideSelect(select) {
        if (select.name == "region") {
            if (select.value != "") {
                setDistrict(true);
                if (previousReg != select.value) {
                    setSuburb(false);
                }

                previousReg = select.value;
            }
            else {
                setDistrict(false);
                setSuburb(false);
            }
        }
        else if (select.name == "district") {
            if (select.value != "") {
                setSuburb(true);
            }
            else {
                setSuburb(false);
            }
        }
    }
    function setDistrict(b) {
        var districtLabel = document.getElementById("districtLbl");
        var districtSelect = document.getElementById("district");
        if (b) {
            districtLabel.style.display = 'inline';
            districtSelect.style.display = 'inline';
        }
        else {
            districtLabel.style.display = 'none';
            districtSelect.style.display = 'none';
        }
    }

    function setSuburb(b) {
        var suburbSelect = document.getElementById("suburb");
        var suburbLabel = document.getElementById("suburbLbl");
        if (b) {
            suburbSelect.style.display = 'inline';
            suburbLabel.style.display = 'inline';
        }
        else {
            suburbSelect.style.display = 'none';
            suburbLabel.style.display = 'none';
        }

    }

</script>
<div class="container rounded-corners">
    <h2 class="centertext"><font color="#65B5A2">post</font> job</h2>
    <hr />
    @using (Html.BeginForm("Create", "Job", FormMethod.Post, new { @class = "form-horizontal", role = "form",enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <div class="container-form">

            <div class="form-group">
                @Html.LabelFor(model => model.jobtype, new { @class = "control-label" })
                <select class="form-control" required id="jobtype" name="jobtype">
                    <option>Plumbing</option>
                    <option>Electrical</option>
                    <option>Business</option>
                    <option>Crafts</option>
                    <option>Design and web</option>
                    <option>Legal</option>
                    <option>Personal</option>
                    <option>Pets</option>
                    <option>Photography</option>
                    <option>Repair services</option>
                    <option>Writing/Translation</option>
                </select>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.title, new { @class = "control-label" })
                @Html.TextBoxFor(model => model.title, new { @name = "title", @id = "title", @class = "form-control", @type = "text" })

            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.description, new { @class = "control-label" })
                <textarea rows="3" name="description" required id="description" class=" form-control"></textarea>
            </div>

            <div>Please select an image to upload</div>
            <input name="image" type="file">

            <div class="form-group">
                @Html.LabelFor(model => model.region, new { @class = "control-label" })
                @Html.DropDownListFor(model => model.region, (SelectList)ViewBag.City, "Select your region", new { @class = "form-control", @id = "region", onchange = "selectRegion(1);showHideSelect(this)" })
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.district, new { @class = "control-label", @id = "districtLbl" })
                @Html.DropDownListFor(model => model.district, Enumerable.Empty<SelectListItem>(), "Select your district", new { @class = "form-control", @id = "district", onchange = "selectRegion(2);showHideSelect(this)" })
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.suburb, new { @class = "control-label", @id = "suburbLbl" })
                @Html.DropDownListFor(model => model.suburb, Enumerable.Empty<SelectListItem>(), "Select your suburb", new { @class = "form-control", @id = "suburb", @onchange = "showHideSelect(this)" })
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.duration, new { @class = "control-label", @id = "durationLbl" })
                <select class="form-control" required id="duration" name="duration">
                    <option>Now (24 Hrs)</option>
                    <option>Soon (48 Hrs)</option>
                    <option>Whenever (72 Hrs +)</option>
                </select>
            </div>

            <div class="form-group">
                <input type="submit" value="Create" class="btn-dontpanic" />
                <br />
                <br />
                @if (User.Identity.IsAuthenticated)
                {

                    <p>
                        @Html.ActionLink("Back to your jobs", "Index")
                    </p>
                }
                else
                {
                    <p>
                        @Html.ActionLink("Back", "Browse")
                    </p>

                }
            </div>
        </div>
    }

</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/scripts/Areas.js")
}
